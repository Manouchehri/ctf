Pretty simple rolling xor.

Spent longer trying to get the ordering right tahn anything else.
